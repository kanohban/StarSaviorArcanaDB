<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>스타 세이비어 아르카나 DB</title>
  <script type="module" crossorigin src="./assets/index-DrY0adZU.js"></script>
  <link rel="stylesheet" crossorigin href="./assets/index-DBwFzK5i.css">
  <link rel="stylesheet" href="./assets/header.css">
</head>

<body>
  <div id="root"></div>
  <script src="./assets/header_manager.js"></script>
  <script>
    (function () {
      // 1. Initialize State from LocalStorage
      const html = document.documentElement;
      const body = document.body;

      const savedTheme = localStorage.getItem('theme') || 'dark';
      html.setAttribute('data-theme', savedTheme);

      const savedView = localStorage.getItem('viewMode') || 'pc';
      if (savedView === 'mobile') {
        body.classList.add('mobile-mode');
      }

      // 2. DOM Manipulation Observer
      const observer = new MutationObserver((mutations, obs) => {
        const headerTop = document.querySelector('.header-top');
        // Check for wrapper to prevent infinite loop
        if (headerTop && !document.querySelector('.custom-header-wrapper')) {
          initCustomHeader(headerTop);
          modifyFilters();
        }
      });

      observer.observe(document.body, { childList: true, subtree: true });

      async function initCustomHeader(originalHeaderTop) {
        // Hide original content
        originalHeaderTop.style.display = 'none';

        const appHeader = document.querySelector('.app-header');

        // Create a wrapper for our custom header
        const wrapper = document.createElement('div');
        wrapper.className = 'custom-header-wrapper'; // Add class immediately
        // Insert it first
        appHeader.insertBefore(wrapper, appHeader.firstChild);

        // Initialize HeaderManager
        if (window.HeaderManager) {
          await window.HeaderManager.init(wrapper, 'index');
        } else {
          console.error('HeaderManager not loaded');
        }
      }

      function modifyFilters() {
        const options = document.querySelectorAll('option');
        options.forEach(opt => {
          if (opt.textContent === '모든 등급') opt.textContent = '등급';
          if (opt.textContent === '모든 타입') opt.textContent = '타입';
        });
      }
    })();
  </script>
  <style>
    /* Mobile Optimization for Header Bottom */
    @media (max-width: 768px) {
      /* .app-header padding removed to match global header.css */

      .header-bottom {
        flex-direction: row !important;
        /* Force row */
        flex-wrap: nowrap !important;
        gap: 0.5rem !important;
      }

      .filter-group {
        width: auto !important;
        flex: 0 0 auto;
      }

      .search-input {
        width: 100% !important;
        flex: 1 !important;
        max-width: none !important;
      }

      .filter-select {
        padding: 8px 12px !important;
        /* Smaller padding */
        font-size: 0.9rem !important;
      }
    }
  </style>
</body>

</html>