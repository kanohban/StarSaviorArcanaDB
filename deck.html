<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>스타 세이비어 DB - 덱</title>
    <link rel="icon" type="image/png" href="./images/index/index_icon.png">
    <link rel="stylesheet" crossorigin href="./assets/index-DBwFzK5i.css">
    <link rel="stylesheet" href="./assets/header.css?v=6.1.0">
    <link rel="stylesheet" href="./assets/deck.css?v=6.1.0">
    <link rel="stylesheet" href="./assets/modal.css?v=6.1.0">
</head>

<body>
    <div class="app">
        <div class="deck-header-wrapper">
            <header id="header-container"></header>

            <div class="deck-controls-header">
                <div class="deck-controls-row">
                    <!-- Deck Navigation (Presets) -->
                    <div class="deck-navigation">
                        <button id="prev-deck-btn" class="nav-btn">&lt;</button>
                        <h2>프리셋 <span id="deck-index">1</span></h2>
                        <button id="next-deck-btn" class="nav-btn">&gt;</button>
                    </div>
                </div>

                <!-- Deck Slots Wrapper for Layout -->
                <div class="deck-slots-wrapper"
                    style="display: flex; align-items: center; justify-content: center; gap: 15px; width: 100%; max-width: 800px; margin: 0 auto; padding-left: 50px;">
                    <!-- Deck Slots -->
                    <div class="deck-slots" id="deck-slots" style="flex:1; margin:0;">
                        <!-- Slots generated by JS -->
                    </div>

                    <!-- Level Toggle (Moved Here) -->
                    <div class="level-toggle-wrapper" style="position: static; transform: none; width: auto;">
                        <div class="custom-level-toggle" style="flex-direction: column; padding: 4px 2px;">
                            <button class="level-btn active" data-level="35"
                                style="font-size: 0.8rem; padding: 4px 8px;">Lv.35</button>
                            <button class="level-btn" data-level="50"
                                style="font-size: 0.8rem; padding: 4px 8px;">Lv.50</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <main class="deck-container">
            <!-- Summary Panel -->
            <section class="deck-summary">
                <div class="summary-header">
                    <h3>덱 요약</h3>
                    <!-- Level toggle moved to header -->
                </div>

                <div class="summary-content">
                    <div class="summary-column">
                        <h4>고유 잠재</h4>
                        <ul id="potential-list" class="potential-list">
                            <li class="empty-message">카드를 선택해주세요.</li>
                        </ul>
                    </div>
                    <div class="summary-column">
                        <h4>합산 스테이터스</h4>
                        <div id="stat-summary" class="stat-summary">
                            <div class="empty-message">카드를 선택해주세요.</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Card Selection -->
            <section class="card-selection">
                <h3>카드 선택</h3>
                <div class="search-bar">
                    <input type="text" id="card-search" placeholder="카드 이름, 효과 검색..." autocomplete="off">
                </div>
                <div class="card-grid" id="card-list">
                    <!-- Cards will be loaded here -->
                </div>
            </section>
        </main>

        <footer id="footer-container"></footer>
    </div>

    <script src="./assets/header_manager.js?v=6.1.0"></script>
    <script src="./assets/footer_manager.js"></script>
    <script src="./assets/hangul_utils.js?v=6.1.0"></script>
    <script src="./assets/deck_manager.js?v=6.1.0"></script>
    <script>
        // Initialize State from LocalStorage (Immediate Apply)
        (function () {
            const html = document.documentElement;
            const body = document.body;

            const savedTheme = localStorage.getItem('theme') || 'dark';
            html.setAttribute('data-theme', savedTheme);

            const savedView = localStorage.getItem('viewMode') || 'pc';
            if (savedView === 'mobile') {
                body.classList.add('mobile-mode');
            }
        })();

        // Initialize Managers
        document.addEventListener('DOMContentLoaded', () => {
            if (window.HeaderManager) {
                window.HeaderManager.init(document.getElementById('header-container'), 'deck');
            }
            if (window.FooterManager) {
                window.FooterManager.init(document.getElementById('footer-container'));
            }
            if (window.DeckManager) {
                window.DeckManager.init();
            }
        });
    </script>
</body>

</html>